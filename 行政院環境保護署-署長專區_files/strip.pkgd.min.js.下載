!function(b,y){"function"==typeof define&&define.amd?define(["jquery"],y):"object"==typeof module&&module.exports?module.exports=y(require("jquery")):b.Strip=y(jQuery)}(this,function(b){function y(){return this.initialize.apply(this,B.call(arguments))}function K(){return this.initialize.apply(this,B.call(arguments))}function G(a){var d={type:"image"};return b.each(U,function(e,c){var f=c.data(a);f&&(d=f,d.type=e,d.url=a)}),d}function H(a){return(a=(a||"").replace(/\?.*/g,"").match(/\.([^.]{3,4})$/))?
a[1].toLowerCase():null}function C(){this.initialize.apply(this,B.call(arguments))}var w={version:"1.6.4",Skins:{strip:{}}},q=function(a){function d(e){return(e=(new RegExp(e+"([\\d.]+)")).exec(a))?parseFloat(e[1]):!0}return{IE:!(!window.attachEvent||-1!==a.indexOf("Opera"))&&d("MSIE "),Opera:-1<a.indexOf("Opera")&&(!!window.opera&&opera.version&&parseFloat(opera.version())||7.55),WebKit:-1<a.indexOf("AppleWebKit/")&&d("AppleWebKit/"),Gecko:-1<a.indexOf("Gecko")&&-1===a.indexOf("KHTML")&&d("rv:"),
MobileSafari:!!a.match(/Apple.*Mobile.*Safari/),Chrome:-1<a.indexOf("Chrome")&&d("Chrome/"),ChromeMobile:-1<a.indexOf("CrMo")&&d("CrMo/"),Android:-1<a.indexOf("Android")&&d("Android "),IEMobile:-1<a.indexOf("IEMobile")&&d("IEMobile/")}}(navigator.userAgent),B=Array.prototype.slice,D={within:function(a,d,e){var c=b.extend({height:!0,width:!0},e||{}),f=b.extend({},d);e=5;var g=c.width;for(c=c.height;0<e&&(g&&f.width>a.width||c&&f.height>a.height);){var h=1,m=1;g&&f.width>a.width&&(h=a.width/f.width);
c&&f.height>a.height&&(m=a.height/f.height);f=Math.min(h,m);f={width:Math.round(d.width*f),height:Math.round(d.height*f)};e--}return f.width=Math.max(f.width,0),f.height=Math.max(f.height,0),f}};b.extend(b.easing,{stripEaseInCubic:function(a,d,e,c,f){return c*(d/=f)*d*d+e},stripEaseInSine:function(a,d,e,c,f){return-c*Math.cos(d/f*(Math.PI/2))+c+e},stripEaseOutSine:function(a,d,e,c,f){return c*Math.sin(d/f*(Math.PI/2))+e}});var t=function(){function a(h,m){var n=h.charAt(0).toUpperCase()+h.substr(1);
n=(h+" "+e.join(n+" ")+n).split(" ");a:{for(l in n)if(void 0!==d.style[n[l]]){var l="prefix"==m?n[l]:!0;break a}l=!1}return l}var d=document.createElement("div"),e=["Webkit","Moz","O","ms","Khtml"],c={animation:a("animation"),transform:a("transform"),prefixed:function(h){return a(h,"prefix")}},f=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;try{var g=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}catch(h){g=
!1}return{css:c,svg:f,touch:g}}();t.mobileTouch=t.touch&&(q.MobileSafari||q.Android||q.IEMobile||q.ChromeMobile||!/^(Win|Mac|Linux)/.test(navigator.platform));var L={viewport:function(){var a={width:b(window).width()};a.height=q.MobileSafari||q.Android&&q.Gecko?document.documentElement.clientWidth/window.innerWidth*window.innerHeight:b(window).height();return a}},M=function(a){var d=function(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))};a.extend(d.prototype,{initialize:function(c){this.options=
a.extend({test:function(){},success:function(){},timeout:function(){},callAt:!1,intervals:[[0,0],[1E3,10],[2E3,50],[4E3,100],[2E4,500]]},c||{});this._test=this.options.test;this._success=this.options.success;this._timeout=this.options.timeout;this._time=this._ipos=0;this._delay=this.options.intervals[this._ipos][1];this._callTimeouts=[];this.poll();this._createCallsAt()},poll:function(){this._polling=setTimeout(a.proxy(function(){if(this._test())return void this.success();if(this._time+=this._delay,
this._time>=this.options.intervals[this._ipos][0]){if(!this.options.intervals[this._ipos+1])return void("function"==a.type(this._timeout)&&this._timeout());this._ipos++;this._delay=this.options.intervals[this._ipos][1]}this.poll()},this),this._delay)},success:function(){this.abort();this._success()},_createCallsAt:function(){this.options.callAt&&a.each(this.options.callAt,a.proxy(function(c,f){var g=f[0],h=f[1];g=setTimeout(a.proxy(function(){h()},this),g);this._callTimeouts.push(g)},this))},_stopCallTimeouts:function(){a.each(this._callTimeouts,
function(c,f){clearTimeout(f)});this._callTimeouts=[]},abort:function(){this._stopCallTimeouts();this._polling&&(clearTimeout(this._polling),this._polling=null)}});var e=function(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))};return a.extend(e.prototype,{supports:{naturalWidth:"naturalWidth"in new Image},initialize:function(c,f,g,h){return this.img=a(c)[0],this.successCallback=f,this.errorCallback=g,this.isLoaded=!1,this.options=a.extend({method:"onload",pollFallbackAfter:1E3},
h||{}),"onload"!=this.options.method&&this.supports.naturalWidth?void this.poll():void this.load()},poll:function(){this._poll=new d({test:a.proxy(function(){return 0<this.img.naturalWidth},this),success:a.proxy(function(){this.success()},this),timeout:a.proxy(function(){this.error()},this),callAt:[[this.options.pollFallbackAfter,a.proxy(function(){this.load()},this)]]})},load:function(){this._loading=setTimeout(a.proxy(function(){var c=new Image;this._onloadImage=c;c.onload=a.proxy(function(){c.onload=
function(){};this.supports.naturalWidth||(this.img.naturalWidth=c.width,this.img.naturalHeight=c.height,c.naturalWidth=c.width,c.naturalHeight=c.height);this.success()},this);c.onerror=a.proxy(this.error,this);c.src=this.img.src},this))},success:function(){this._calledSuccess||(this._calledSuccess=!0,this.abort(),this.waitForRender(a.proxy(function(){this.isLoaded=!0;this.successCallback(this)},this)))},error:function(){this._calledError||(this._calledError=!0,this.abort(),this._errorRenderTimeout=
setTimeout(a.proxy(function(){this.errorCallback&&this.errorCallback(this)},this)))},abort:function(){this.stopLoading();this.stopPolling();this.stopWaitingForRender()},stopPolling:function(){this._poll&&(this._poll.abort(),this._poll=null)},stopLoading:function(){this._loading&&(clearTimeout(this._loading),this._loading=null);this._onloadImage&&(this._onloadImage.onload=function(){},this._onloadImage.onerror=function(){})},waitForRender:function(c){this._renderTimeout=setTimeout(c)},stopWaitingForRender:function(){this._renderTimeout&&
(clearTimeout(this._renderTimeout),this._renderTimeout=null);this._errorRenderTimeout&&(clearTimeout(this._errorRenderTimeout),this._errorRenderTimeout=null)}}),e}(jQuery);y.supported=t.css.transform&&t.css.animation;b.extend(y.prototype,{initialize:function(a,d){this.element=b(a);this.element[0]&&(this.classPrefix="strp-",this.setOptions(d||{}),this.element.addClass(this.classPrefix+"spinner"),this.element.append(this._rotate=b("<div>").addClass(this.classPrefix+"spinner-rotate")),this.build(),this.start())},
setOptions:function(a){this.options=b.extend({show:200,hide:200},a||{})},build:function(){if(!this._build){this._rotate.html("");var a=(2*(this.options.length+this.options.radius),this.element.is(":visible"));a||this.element.show();var d,e;this._rotate.append(d=b("<div>").addClass(this.classPrefix+"spinner-frame").append(e=b("<div>").addClass(this.classPrefix+"spinner-line")));var c=parseInt(b(e).css("z-index"));this.lines=c;e.css({"z-index":"inherit"});d.remove();a||this.element.hide();for(a=0;c>
a;a++){this._rotate.append(d=b("<div>").addClass(this.classPrefix+"spinner-frame").append(e=b("<div>").addClass(this.classPrefix+"spinner-line")));var f=f||e.css("color");e.css({background:f});d.css({opacity:(1/c*(a+1)).toFixed(2)});e={};e[t.css.prefixed("transform")]="rotate("+360/c*(a+1)+"deg)";d.css(e)}this._build=!0}},start:function(){var a={};a[t.css.prefixed("animation")]=this.classPrefix+"spinner-spin 1s infinite steps("+this.lines+")";this._rotate.css(a)},stop:function(){var a={};a[t.css.prefixed("animation")]=
"none";this._rotate.css(a)},show:function(a){this.build();this.start();this.element.stop(!0).fadeTo(this.options.show,1,a)},hide:function(a){this.element.stop(!0).fadeOut(this.options.hide,b.proxy(function(){this.stop();a&&a()},this))},refresh:function(){this._build=!1;this.build()}});b.extend(K.prototype,{initialize:function(){this._timers={}},set:function(a,d,e){this._timers[a]=setTimeout(d,e)},get:function(a){return this._timers[a]},clear:function(a){a?this._timers[a]&&(clearTimeout(this._timers[a]),
delete this._timers[a]):this.clearAll()},clearAll:function(){b.each(this._timers,function(a,d){clearTimeout(d)});this._timers={}}});var U={image:{extensions:"bmp gif jpeg jpg png webp",detect:function(a){return-1<b.inArray(H(a),this.extensions.split(" "))},data:function(a){return this.detect()?{extension:H(a)}:!1}},youtube:{detect:function(a){var d=/(youtube\.com|youtu\.be)\/watch\?(?=.*vi?=([a-zA-Z0-9-_]+))(?:\S+)?$/.exec(a);return d&&d[2]?d[2]:(d=/(youtube\.com|youtu\.be)\/(vi?\/|u\/|embed\/)?([a-zA-Z0-9-_]+)(?:\S+)?$/i.exec(a),
d&&d[3]?d[3]:!1)},data:function(a){return(a=this.detect(a))?{id:a}:!1}},vimeo:{detect:function(a){return(a=/(vimeo\.com)\/([a-zA-Z0-9-_]+)(?:\S+)?$/i.exec(a))&&a[2]?a[2]:!1},data:function(a){return(a=this.detect(a))?{id:a}:!1}}},V=function(){var a=function(){return this.initialize.apply(this,B.call(arguments))};b.extend(a.prototype,{initialize:function(e,c){this.url=e;this.callback=c;this.load()},load:function(){var e=d.get(this.url);if(e)return this.callback(e.data);e="http"+(window.location&&"https:"==
window.location.protocol?"s":"")+":";var c=G(this.url).id;this._xhr=b.getJSON(e+"//vimeo.com/api/oembed.json?url="+e+"//vimeo.com/"+c+"&maxwidth=9999999&maxheight=9999999&callback=?",b.proxy(function(f){f={dimensions:{width:f.width,height:f.height}};d.set(this.url,f);this.callback&&this.callback(f)},this))},abort:function(){this._xhr&&(this._xhr.abort(),this._xhr=null)}});var d={cache:[],get:function(e){for(var c=null,f=0;f<this.cache.length;f++)this.cache[f]&&this.cache[f].url==e&&(c=this.cache[f]);
return c},set:function(e,c){this.remove(e);this.cache.push({url:e,data:c})},remove:function(e){for(var c=0;c<this.cache.length;c++)this.cache[c]&&this.cache[c].url==e&&delete this.cache[c]}};return a}(),I={defaults:{effects:{spinner:{show:200,hide:200},transition:{min:175,max:250},ui:{show:0,hide:200},window:{show:300,hide:300}},hideOnClickOutside:!0,keyboard:{left:!0,right:!0,esc:!0},loop:!0,overlap:!0,preload:[1,2],position:!0,skin:"strip",side:"right",spinner:!0,toggle:!0,uiDelay:3E3,vimeo:{autoplay:1,
api:1,title:1,byline:1,portrait:0,loop:0},youtube:{autoplay:1,controls:1,enablejsapi:1,hd:1,iv_load_policy:3,loop:0,modestbranding:1,rel:0,vq:"hd1080"},initialTypeOptions:{image:{},vimeo:{width:1280},youtube:{width:1280,height:720}}},create:function(a,d,e){a=a||{};a.skin=a.skin||this.defaults.skin;e=a.skin?b.extend({},w.Skins[a.skin]||w.Skins[this.defaults.skin]):{};e=b.extend(!0,{},this.defaults,e);e.initialTypeOptions&&(d&&e.initialTypeOptions[d]&&(e=b.extend(!0,{},e.initialTypeOptions[d],e)),delete e.initialTypeOptions);
var c=b.extend(!0,{},e,a);return(!c.effects||q.IE&&9>q.IE)&&(c.effects={},b.each(this.defaults.effects,function(f,g){b.each(c.effects[f]=b.extend({},g),function(h){c.effects[f][h]=0})}),c.spinner=!1),c.keyboard&&("boolean"==b.type(c.keyboard)&&(c.keyboard={},b.each(this.defaults.keyboard,function(f){c.keyboard[f]=!0})),("vimeo"==d||"youtube"==d)&&b.extend(c.keyboard,{left:!1,right:!1})),("vimeo"==d||"youtube"==d)&&(c.overlap=!1),c}};b.extend(C.prototype,{initialize:function(a,d){var e=d||{};if("string"==
b.type(a))a={url:a};else if(a&&1==a.nodeType){var c=b(a);a={element:c[0],url:c.attr("href"),caption:c.data("strip-caption"),group:c.data("strip-group"),extension:c.data("strip-extension"),type:c.data("strip-type"),options:c.data("strip-options")&&eval("({"+c.data("strip-options")+"})")||{}}}a&&(a.extension||(a.extension=H(a.url)),!a.type)&&(c=G(a.url),a._data=c,a.type=c.type);return a._data||(a._data=G(a.url)),a.options=a&&a.options?b.extend(!0,b.extend({},e),b.extend({},a.options)):b.extend({},e),
a.options=I.create(a.options,a.type,a._data),b.extend(this,a),this}});var p={initialize:function(a){this.element=a;this.pages={};this.uid=1},add:function(a){this.uid++;this.views=a;this.pages[this.uid]=[];k._showUIOnResize=!0;b.each(a,b.proxy(function(d,e){this.pages[this.uid].push(new W(e,d+1,this.views.length))},this))},show:function(a,d){var e=this.pages[this.uid][a-1];return this.page&&this.page.uid==e.uid?void(e.view.options.toggle&&(k.hide(),this.page=null)):(p.setActiveClass(e),this.page=e,
this.removeHiddenAndLoadingInactive(),void e.show(b.proxy(function(){this._switched=!1;d&&d()},this)))},getLoadingCount:function(){var a=0;return b.each(this.pages,function(d,e){b.each(e,function(c,f){f.loading&&a++})}),a},getPositionInActivePageGroup:function(a){var d=0,e=this.pages[this.uid];return e&&b.each(e,function(c,f){f.view.element&&f.view.element==a&&(d=c+1)}),d},removeExpired:function(a){b.each(this.pages,function(d,e){d!=this._id&&b.each(e,function(c,f){f.remove(a)})})},removeAll:function(){b.each(this.pages,
function(a,d){b.each(d,function(e,c){c.remove()})});this.pages={}},hideVisibleInactive:function(a){b.each(this.pages,b.proxy(function(d,e){b.each(e,b.proxy(function(c,f){f.uid!=this.page.uid&&f.hide(null,a)},this))},this))},stopInactive:function(){b.each(this.pages,b.proxy(function(a,d){b.each(d,b.proxy(function(e,c){c.uid==this.page.uid||c.preloading||c.stop()},this))},this))},removeHiddenAndLoadingInactive:function(){var a=[];b.each(this.pages,b.proxy(function(d,e){if(d!=this.uid){var c=0;b.each(e,
b.proxy(function(f,g){g.visible&&!g.loading||g.animatingWindow||g.remove();g.removed&&c++},this));c==e.length&&a.push(d)}},this));b.each(a,b.proxy(function(d,e){delete this.pages[e]},this))},stop:function(){b.each(this.pages,function(a,d){b.each(d,function(e,c){c.stop()})})},setActiveClass:function(a){this.removeActiveClasses();if(a=a.view.element)b(a).addClass("strip-active-element strip-active-group"),(a=b(a).data("strip-group"))&&b('.strip[data-strip-group="'+a+'"]').addClass("strip-active-group")},
removeActiveClasses:function(){b(".strip-active-group").removeClass("strip-active-group strip-active-element")}},W=function(){function a(){return this.initialize.apply(this,B.call(arguments))}var d=0,e={};return b.extend(a.prototype,{initialize:function(c,f,g){this.view=c;this.dimensions={width:0,height:0};this.uid=d++;this._position=f;this._total=g;this.visible=this.animated=!1;this.queues={};this.queues.showhide=b({})},create:function(){if(!this._created){p.element.append(this.element=b("<div>").addClass("strp-page").append(this.container=
b("<div>").addClass("strp-container")).css({opacity:0}).hide());var c=this.view.options.position&&1<this._total;switch((this.view.caption||c)&&(this.element.append(this.info=b("<div>").addClass("strp-info").append(this.info_padder=b("<div>").addClass("strp-info-padder"))),c&&(this.element.addClass("strp-has-position"),this.info_padder.append(b("<div>").addClass("strp-position").html(this._position+" / "+this._total))),this.view.caption&&this.info_padder.append(this.caption=b("<div>").addClass("strp-caption").html(this.view.caption))),
this.view.type){case "image":this.container.append(this.content=b("<img>").attr({src:this.view.url}));break;case "vimeo":case "youtube":this.container.append(this.content=b("<div>"))}this.element.addClass("strp"+(this.view.options.overlap?"":"-no")+"-overlap");2>this._total&&this.element.addClass("strp-no-sides");this.content.addClass("strp-content-element").attr("alt",this.view.caption);this._created=!0}},_getSurroundingPages:function(){var c;if(!(c=this.view.options.preload))return[];var f=[],g=
Math.max(1,this._position-c[0]);c=Math.min(this._position+c[1],this._total);for(var h=this._position,m=h;c>=m;m++){var n=p.pages[p.uid][m-1];n._position!=h&&f.push(n)}for(m=h;m>=g;m--)n=p.pages[p.uid][m-1],n._position!=h&&f.push(n);return f},preloadSurroundingImages:function(){var c=this._getSurroundingPages();b.each(c,b.proxy(function(f,g){g.preload()},this))},preload:function(){this.preloading||this.preloaded||"image"!=this.view.type||!this.view.options.preload||this.loaded||(this.create(),this.preloading=
!0,new M(this.content[0],b.proxy(function(c){this.loaded=!0;this.preloading=!1;this.preloaded=!0;this.dimensions={width:c.img.naturalWidth,height:c.img.naturalHeight}},this),null,{method:"naturalWidth"}))},load:function(c){if(this.create(),this.loaded)return void(c&&c());switch(this.abort(),this.loading=!0,this.view.options.spinner&&!e[this.view.url]&&k.startLoading(),this.view.type){case "image":if(this.error)return void(c&&c());this.imageReady=new M(this.content[0],b.proxy(function(f){this._markAsLoaded();
this.dimensions={width:f.img.naturalWidth,height:f.img.naturalHeight};c&&c()},this),b.proxy(function(){this._markAsLoaded();this.content.hide();this.container.append(this.error=b("<div>").addClass("strp-error"));this.element.addClass("strp-has-error");this.dimensions={width:this.error.outerWidth(),height:this.error.outerHeight()};c&&c()},this),{method:"naturalWidth"});break;case "vimeo":this.vimeoReady=new V(this.view.url,b.proxy(function(f){this._markAsLoaded();this.dimensions={width:f.dimensions.width,
height:f.dimensions.height};c&&c()},this));break;case "youtube":this._markAsLoaded(),this.dimensions={width:this.view.options.width,height:this.view.options.height},c&&c()}},_markAsLoaded:function(){this.loading=!1;this.loaded=!0;e[this.view.url]=!0;k.stopLoading()},isVideo:function(){return/^(youtube|vimeo)$/.test(this.view.type)},insertVideo:function(c){if(this.playerIframe||!this.isVideo())return void(c&&c());var f="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":",g=b.extend({},
this.view.options[this.view.type]||{});g=b.param(g);f={vimeo:f+"//player.vimeo.com/video/{id}?{queryString}",youtube:f+"//www.youtube.com/embed/{id}?{queryString}"}[this.view.type].replace("{id}",this.view._data.id).replace("{queryString}",g);this.content.append(this.playerIframe=b("<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen>").attr({src:f,height:this.contentDimensions.height,width:this.contentDimensions.width,frameborder:0}));c&&c()},raise:function(){var c=p.element[0].lastChild;
c&&c==this.element[0]||p.element.append(this.element)},show:function(c){var f=this.queues.showhide;f.queue([]);this.animated=!0;this.animatingWindow=!1;f.queue(function(g){p.stopInactive();g()});f.queue(b.proxy(function(g){k.setSide(this.view.options.side,g)},this));f.queue(b.proxy(function(g){this.view.options.spinner&&k._spinner&&(k.setSpinnerSkin(this.view.options.skin),k._spinner.setOptions(this.view.options.effects.spinner),k._spinner.refresh());this.load(b.proxy(function(){this.preloadSurroundingImages();
g()},this))},this));f.queue(b.proxy(function(g){this.raise();k.setSkin(this.view.options.skin);k.bindUI();N.enable(this.view.options.keyboard);this.fitToWindow();g()},this));f.queue(b.proxy(function(g){k.timers.set("bind-hide-on-click-outside",b.proxy(function(){k.bindHideOnClickOutside();g()},this),1)},this));this.isVideo()&&f.queue(b.proxy(function(g){this.insertVideo(b.proxy(function(){g()}))},this));f.queue(b.proxy(function(g){this.animatingWindow=!0;var h=3,m="horizontal"==this.getOrientation()?
"width":"height",n=this.view&&this.view.options.onShow;"function"==b.type(n)&&n.call(w);var l=k.resize(this[m],function(){1>--h&&g()},l);this._show(function(){1>--h&&g()},l);k.adjustPrevNext(function(){1>--h&&g()},l);k._showUIOnResize&&(k.showUI(null,l),k._showUIOnResize=!1);p.hideVisibleInactive(l)},this));f.queue(b.proxy(function(g){this.animated=this.animatingWindow=!1;this.visible=!0;c&&c();g()},this))},_show:function(c,f){var g=k.visible?"number"==b.type(f)?f:this.view.options.effects.transition.min:
0;this.element.stop(!0).show().fadeTo(g||0,1,c)},hide:function(c,f){if(this.element){this.removeVideo();this.abort();var g=this.view.options.effects.transition.min;"number"==b.type(f)&&(g=f);this.isVideo()&&(g=0);this.element.stop(!0).fadeTo(g,0,"stripEaseInCubic",b.proxy(function(){this.element.hide();this.visible=!1;c&&c()},this))}},stop:function(){this.queues.showhide.queue([]);this.element&&this.element.stop(!0);this.abort()},removeVideo:function(){this.playerIframe&&(this.playerIframe[0].src=
"//about:blank",this.playerIframe.remove(),this.playerIframe=null)},remove:function(){this.stop();this.removeVideo();this.element&&this.element.remove();this.visible=!1;this.removed=!0},abort:function(){this.imageReady&&!this.preloading&&(this.imageReady.abort(),this.imageReady=null);this.vimeoReady&&(this.vimeoReady.abort(),this.vimeoReady=null);this.loading=!1;k.stopLoading()},_getDimensionsFitToView:function(){var c=b.extend({},this.dimensions),f=b.extend({},this.dimensions),g=this.view.options;
return g.maxWidth&&(c.width=g.maxWidth),g.maxHeight&&(c.heigth=g.maxHeight),D.within(c,f)},getOrientation:function(){return"left"==this.view.options.side||"right"==this.view.options.side?"horizontal":"vertical"},fitToWindow:function(){var c=this.element,f=this._getDimensionsFitToView(),g=L.viewport(),h=b.extend({},g),m="horizontal"==this.getOrientation()?"width":"height",n=c.find(".strp-container");k.element.removeClass("strp-measured");var l=k.element,x="width"==m?0<parseInt(l.css("min-width")):
0<parseInt(l.css("min-height"));l=x?0:parseInt(l.css("margin-"+("width"==m?"left":"bottom")));k.element.addClass("strp-measured");h[m]-=l;var z=parseInt(n.css("padding-left"))+parseInt(n.css("padding-right")),O=parseInt(n.css("padding-top"))+parseInt(n.css("padding-bottom"));h.width-=z;h.height-=O;var v=D.within(h,f);l=b.extend({},v);var A=this.content;this.error&&(A=this.error);var E=this.info,u=0;if(E){var P=k.element.is(":visible");P||k.element.show();var Q=c.is(":visible");if(Q||c.show(),"width"==
m){c.css({width:x?g.width:v.width+z});var R=h.height;A.hide();u=E.outerHeight();A.show();h.height=R-u;l=D.within(h,f);for(var S,T,F,X=b.extend({},l),Y=u,J=x?0:4;0<J&&(F=v.width-l.width);)c.css({width:v.width+z-F}),T=u,A.hide(),u=E.outerHeight(),S=Math.max(this.caption?this.caption.outerWidth()+z:0,this.position?this.position.outerWidth()+z:0),A.show(),u==T&&S<=v.width+z-F?v.width-=F:(h.height=R-u,l=D.within(h,f),0>=J-1&&(c.css({width:v.width+z}),l=X,u=Y)),J--}else q.IE&&8>q.IE&&c.css({width:g.width}),
A.hide(),u=E.outerHeight(),A.show(),h.height-=u,l=D.within(h,f),v.height=l.height;Q||c.hide();P||k.element.hide()}f={width:v.width+z,height:v.height+O+u};x&&(f=g);c.css("width"==m?{width:f.width}:{height:f.height});n.css({bottom:u});c=-.5*l.width;g=-.5*l.height;q.IE&&8>q.IE&&(c=Math.floor(c),g=Math.floor(g));A.css(b.extend({},l,{"margin-left":c,"margin-top":g}));this.playerIframe&&this.playerIframe.attr(l);this.contentDimensions=l;this.width=f.width;this.height=f.height;this.z=this[m]}}),a}(),k={initialize:function(){this.queues=
[];this.queues.hide=b({});this.pages=[];this.timers=new K;this.build();this.setSkin(I.defaults.skin)},build:function(){y.supported&&(b(document.body).append(this.spinnerMove=b("<div>").addClass("strp-spinner-move").hide().append(this.spinner=b("<div>").addClass("strp-spinner"))),this._spinner=new y(this.spinner),this._spinnerMoveSkinless=this.spinnerMove[0].className);b(document.body).append(this.element=b("<div>").addClass("strp-window strp-measured").append(this._pages=b("<div>").addClass("strp-pages")).append(this._close=
b("<div>").addClass("strp-close").attr("tabindex",0).text("\u95dc\u9589").append(b("<div>").addClass("strp-close-background")).append(b("<div>").addClass("strp-close-icon"))).append(this._previous=b("<div>").addClass("strp-nav strp-nav-previous").text("\u4e0a\u4e00\u5f35").append(b("<div>").addClass("strp-nav-button").attr("tabindex",0).append(b("<div>").addClass("strp-nav-button-background")).append(b("<div>").addClass("strp-nav-button-icon"))).hide()).append(this._next=b("<div>").addClass("strp-nav strp-nav-next").text("\u4e0b\u4e00\u5f35").append(b("<div>").addClass("strp-nav-button").attr("tabindex",
0).append(b("<div>").addClass("strp-nav-button-background")).append(b("<div>").addClass("strp-nav-button-icon"))).hide()));p.initialize(this._pages);t.mobileTouch&&this.element.addClass("strp-mobile-touch");t.svg||this.element.addClass("strp-no-svg");this._close.on("click",b.proxy(function(a){a.preventDefault();this.hide()},this));this._previous.on("click",b.proxy(function(a){this.previous();this._onMouseMove(a)},this));this._next.on("click",b.proxy(function(a){this.next();this._onMouseMove(a)},this));
this.hideUI(null,0)},setSkin:function(a){this._skin&&this.element.removeClass("strp-window-skin-"+this._skin);this.element.addClass("strp-window-skin-"+a).find(".strp-close").focus();this._skin=a},setSpinnerSkin:function(a){this.spinnerMove&&(this._spinnerSkin&&this.spinnerMove.removeClass("strp-spinner-move-skin-"+this._spinnerSkin),this.spinnerMove.addClass("strp-spinner-move-skin-"+a),this._spinner.refresh(),this._spinnerSkin=a)},startObservingResize:function(){this._isObservingResize||(this._onWindowResizeHandler=
b.proxy(this._onWindowResize,this),b(window).on("resize orientationchange",this._onWindowResizeHandler),this._isObservingResize=!0)},stopObservingResize:function(){this._onWindowResizeHandler&&(b(window).off("resize orientationchange",this._onWindowResizeHandler),this._onWindowResizeHandler=null);this._isObservingResize=!1},_onWindowResize:function(){var a;(a=p.page)&&(a.animated||a.animatingWindow?(a.fitToWindow(),a.show()):(a.fitToWindow(),this.resize(a.z,null,0),this.adjustPrevNext(null,!0)))},
resize:function(a,d,e){var c="vertical"==this.getOrientation()?"Height":"Width",f=c.toLowerCase();0<a&&(this.visible=!0,this.startObservingResize());c=k.element["outer"+c]();if(0==c)c=this.view.options.effects.window.show,this.element.addClass("strp-opening"),this.opening=!0;else if("number"==b.type(e))c=e;else{var g=this.view.options.effects.transition;e=g.min;g=g.max-e;var h=L.viewport();c=Math.round(e+Math.min(1,Math.abs(c-a)/h[f])*g)}0==a&&(this.closing=!0,this.element.is(":animated")||this.element.addClass("strp-closing"));
e={overflow:"visible"};e[f]=a;var m=1;this._offsetLeft=this._outerWidth=null;var n=this.view.options.onResize;a="function"==b.type(n);return this.element.stop(!0).animate(e,b.extend({duration:c,complete:b.proxy(function(){1>--m&&this._afterResize(d)},this)},a?{step:b.proxy(function(l,x){x.prop==f&&n.call(w,x.prop,l,this.side)},this)}:{})),this.spinnerMove&&(m++,this.spinnerMove.stop(!0).animate(e,c,b.proxy(function(){1>--m&&this._afterResize(d)},this))),c},_afterResize:function(a){this.closing=this.opening=
!1;this.element.removeClass("strp-opening strp-closing");this._outerWidth=this.element.outerWidth();this._offsetLeft=this.element.offset().left;a&&a()},adjustPrevNext:function(a,d){if(this.view&&p.page){var e=p.page,c=this.element.is(":visible");c||this.element.show();var f=this._previous.attr("style");this._previous.removeAttr("style");var g=parseInt(this._previous.css("margin-top"));this._previous.attr({style:f});c||this.element.hide();c=e.info?e.info.outerHeight():0;e=this._previous.add(this._next);
g={"margin-top":g-.5*c};c=this.view.options.effects.transition.min;"number"==b.type(d)&&(c=d);this.opening&&(c=0);e.stop(!0).animate(g,c,a);this._previous[this.mayPrevious()?"show":"hide"]();this._next[this.mayNext()?"show":"hide"]()}},resetPrevNext:function(){this._previous.add(this._next).stop(!0).removeAttr("style")},load:function(a,d){this.views=a;p.add(a);d&&this.setPosition(d)},setSide:function(a,d){if(this.side==a)return void(d&&d());this.visible?(this.hideUI(null,this.view?this.view.options.effects.window.hide:
0),this.unbindUI(),this.resize(0,b.proxy(function(){this._safeResetsAfterSwitchSide();p.hideVisibleInactive(0);this._setSide(a,d)},this)),this._showUIOnResize=!0):this._setSide(a,d)},_setSide:function(a,d){this.side=a;var e=this.getOrientation(),c=this.element;this.spinnerMove&&(c=c.add(this.spinnerMove));c.removeClass("strp-horizontal strp-vertical").addClass("strp-"+e);c.removeClass("strp-side-top strp-side-right strp-side-bottom strp-side-left").addClass("strp-side-"+a);d&&d()},getOrientation:function(){return"left"==
this.side||"right"==this.side?"horizontal":"vertical"},startLoading:function(){this._spinner&&(this.spinnerMove.show(),this._spinner.show())},stopLoading:function(){this._spinner&&1>p.getLoadingCount()&&this._spinner.hide(b.proxy(function(){this.spinnerMove.hide()},this))},setPosition:function(a,d){this._position=a;this.view=this.views[a-1];this.stopHideQueue();this.page=p.show(a,b.proxy(function(){var e=this.view.options.afterPosition;"function"==b.type(e)&&e.call(w,a);d&&d()},this))},hide:function(a){if(this.view){var d=
this.queues.hide;d.queue([]);d.queue(b.proxy(function(e){p.stop();e()},this));d.queue(b.proxy(function(e){var c=this.view?this.view.options.effects.window.hide:0;this.unbindUI();this.hideUI(null,c);this.unbindHideOnClickOutside();N.disable();e()},this));d.queue(b.proxy(function(e){p.removeActiveClasses();this.resize(0,e,this.view.options.effects.window.hide);this._showUIOnResize=!0},this));d.queue(b.proxy(function(e){this._safeResetsAfterSwitchSide();this.stopObservingResize();p.removeAll();this.timers.clear();
this._position=-1;var c=this.view&&this.view.options.afterHide;"function"==b.type(c)&&c.call(w);this.view=null;e()},this));"function"==b.type(a)&&d.queue(b.proxy(function(e){a();e()},this))}},stopHideQueue:function(){this.queues.hide.queue([])},_safeResetsAfterSwitchSide:function(){this.element.removeAttr("style");this.spinnerMove&&this.spinnerMove.removeAttr("style");this.visible=!1;this.hideUI(null,0);this.timers.clear("ui");this.resetPrevNext();this._y=this._x=-1},mayPrevious:function(){return this.view&&
this.view.options.loop&&this.views&&1<this.views.length||1!=this._position},previous:function(a){var d=this.mayPrevious();(a||d)&&this.setPosition(this.getSurroundingIndexes().previous)},mayNext:function(){var a=this.views&&1<this.views.length;return this.view&&this.view.options.loop&&a||a&&1!=this.getSurroundingIndexes().next},next:function(a){var d=this.mayNext();(a||d)&&this.setPosition(this.getSurroundingIndexes().next)},getSurroundingIndexes:function(){if(!this.views)return{};var a=this._position,
d=this.views.length;return{previous:1>=a?d:a-1,next:a>=d?1:a+1}},bindHideOnClickOutside:function(){this.unbindHideOnClickOutside();b(document.documentElement).on("click",this._delegateHideOutsideHandler=b.proxy(this._delegateHideOutside,this))},unbindHideOnClickOutside:function(){this._delegateHideOutsideHandler&&(b(document.documentElement).off("click",this._delegateHideOutsideHandler),this._delegateHideOutsideHandler=null)},_delegateHideOutside:function(a){var d=p.page;this.visible&&d&&d.view.options.hideOnClickOutside&&
(b(a.target).closest(".strip, .strp-window")[0]||this.hide()||$(".retiree_info a.strip").setfocus())},bindUI:function(){this.unbindUI();t.mobileTouch||(this.element.on("mouseenter",this._showUIHandler=b.proxy(this.showUI,this)).on("mouseleave",this._hideUIHandler=b.proxy(this.hideUI,this)),this.element.on("mousemove",this._mousemoveUIHandler=b.proxy(function(a){var d=a.pageX;a=a.pageY;this._hoveringNav||a==this._y&&d==this._x||(this._x=d,this._y=a,this.showUI(),this.startUITimer())},this)),this._pages.on("mousemove",
".strp-container",this._onMouseMoveHandler=b.proxy(this._onMouseMove,this)).on("mouseleave",".strp-container",this._onMouseLeaveHandler=b.proxy(this._onMouseLeave,this)).on("mouseenter",".strp-container",this._onMouseEnterHandler=b.proxy(this._onMouseEnter,this)),this.element.on("mouseenter",".strp-nav",this._onNavMouseEnterHandler=b.proxy(this._onNavMouseEnter,this)).on("mouseleave",".strp-nav",this._onNavMouseLeaveHandler=b.proxy(this._onNavMouseLeave,this)),b(window).on("scroll",this._onScrollHandler=
b.proxy(this._onScroll,this)));this._pages.on("click",".strp-container",this._onClickHandler=b.proxy(this._onClick,this))},unbindUI:function(){this._showUIHandler&&(this.element.off("mouseenter",this._showUIHandler).off("mouseleave",this._hideUIHandler).off("mousemove",this._mousemoveUIHandler),this._pages.off("mousemove",".strp-container",this._onMouseMoveHandler).off("mouseleave",".strp-container",this._onMouseLeaveHandler).off("mouseenter",".strp-container",this._onMouseEnterHandler),this.element.off("mouseenter",
".strp-nav",this._onNavMouseEnterHandler).off("mouseleave",".strp-nav",this._onNavMouseLeaveHandler),b(window).off("scroll",this._onScrollHandler),this._showUIHandler=null);this._onClickHandler&&(this._pages.off("click",".strp-container",this._onClickHandler),this._onClickHandler=null)},_onScroll:function(){this._offsetLeft=this._outerWidth=null},_onMouseMove:function(a){a=this._getEventSide(a);var d=a.toLowerCase();this.element[(this["may"+a]()?"add":"remove")+"Class"]("strp-hovering-clickable");
this._previous[("next"!=d?"add":"remove")+"Class"]("strp-nav-previous-hover strp-nav-hover");this._next[("next"==d?"add":"remove")+"Class"]("strp-nav-next-hover strp-nav-hover")},_onMouseLeave:function(){this.element.removeClass("strp-hovering-clickable");this._previous.removeClass("strp-nav-previous-hover").add(this._next.removeClass("strp-nav-next-hover")).removeClass("strp-nav-hover")},_onClick:function(a){this[this._getEventSide(a).toLowerCase()]();this._onMouseMove(a)},_onMouseEnter:function(a){this._onMouseMove(a)},
_getEventSide:function(a){var d=this._offsetLeft||this.element.offset().left;a=a.pageX-d;return.5*(this._outerWidth||this.element.outerWidth())>a?"Previous":"Next"},_onNavMouseEnter:function(){this._hoveringNav=!0;this.clearUITimer()},_onNavMouseLeave:function(){this._hoveringNav=!1;this.startUITimer()},showUI:function(a,d){this.clearUITimer();var e=this.element.find(".strp-nav-button"),c=this.view?this.view.options.effects.ui.show:0;"number"==b.type(d)&&(c=d);e.stop(!0).fadeTo(c,1,"stripEaseInSine",
b.proxy(function(){this.startUITimer();"function"==b.type(a)&&a()},this))},hideUI:function(a,d){this.clearUITimer();var e=this.element.find(".strp-nav-button"),c=this.view?this.view.options.effects.ui.show:0;"number"==b.type(d)&&(c=d);e.stop(!0).fadeTo(c,1,"stripEaseInSine",b.proxy(function(){this.startUITimer();"function"==b.type(a)&&a()},this))},clearUITimer:function(){t.mobileTouch||this.timers.clear("ui")},startUITimer:function(){t.mobileTouch||(this.clearUITimer(),this.timers.set("ui",b.proxy(function(){this.hideUI()},
this),this.view?this.view.options.uiDelay:0))}},N={enabled:!1,keyCode:{left:37,right:39,esc:27},enable:function(a){this.disable();a&&(b(document).on("keydown",this._onKeyDownHandler=b.proxy(this.onKeyDown,this)).on("keyup",this._onKeyUpHandler=b.proxy(this.onKeyUp,this)),this.enabled=a)},disable:function(){this.enabled=!1;this._onKeyUpHandler&&(b(document).off("keyup",this._onKeyUpHandler).off("keydown",this._onKeyDownHandler),this._onKeyUpHandler=this._onKeyDownHandler=null)},onKeyDown:function(a){if(this.enabled&&
k.visible){var d=this.getKeyByKeyCode(a.keyCode);if(d&&(!d||!this.enabled||this.enabled[d]))switch(a.preventDefault(),a.stopPropagation(),d){case "left":k.previous();break;case "right":k.next()}}},onKeyUp:function(a){if(this.enabled&&k.visible&&(a=this.getKeyByKeyCode(a.keyCode))&&(!a||!this.enabled||this.enabled[a]))switch(a){case "esc":k.hide(),$(".retiree_info a.strip").setfocus()}},getKeyByKeyCode:function(a){for(var d in this.keyCode)if(this.keyCode[d]==a)return d;return null}},r={_disabled:!1,
_fallback:!0,initialize:function(){k.initialize();this._disabled||this.startDelegating()},startDelegating:function(){this.stopDelegating();b(document.documentElement).on("click",".strip[href]",this._delegateHandler=b.proxy(this.delegate,this))},stopDelegating:function(){this._delegateHandler&&(b(document.documentElement).off("click",".strip[href]",this._delegateHandler),this._delegateHandler=null)},delegate:function(a){this._disabled||(a.stopPropagation(),a.preventDefault(),r.show(a.currentTarget))},
show:function(a){if(this._disabled)return void this.showFallback.apply(r,B.call(arguments));var d=arguments[1]||{},e=arguments[2];arguments[1]&&"number"==b.type(arguments[1])&&(e=arguments[1],d={});var c=[],f=a&&1==a.nodeType;switch(b.type(a)){case "string":case "object":var g=new C(a,d);if(g.group){if(f){g=b('.strip[data-strip-group="'+b(a).data("strip-group")+'"]');var h={};g.filter("[data-strip-group-options]").each(function(n,l){b.extend(h,eval("({"+(b(l).attr("data-strip-group-options")||"")+
"})"))});g.each(function(n,l){e||l!=a||(e=n+1);c.push(new C(l,b.extend({},h,d)))})}}else h={},f&&b(a).is("[data-strip-group-options]")&&(b.extend(h,eval("({"+(b(a).attr("data-strip-group-options")||"")+"})")),g=new C(a,b.extend({},h,d))),c.push(g);break;case "array":b.each(a,function(n,l){var x=new C(l,d);c.push(x)})}(!e||1>e)&&(e=1);e>c.length&&(e=c.length);k.unbindHideOnClickOutside();var m;f&&(m=p.getPositionInActivePageGroup(a))?(m==k._position&&k.bindHideOnClickOutside(),k.setPosition(m)):k.load(c,
e)},showFallback:function(){function a(d){var e=b.type(d);return"string"==e?d:"array"==e&&d[0]?a(d[0]):_.isElement(d)&&b(d).attr("href")?b(d).attr("href"):d.url?d.url:!1}return function(d){r._fallback&&(d=a(d))&&(window.location.href=d)}}()};return b.extend(w,{show:function(){return r.show.apply(r,B.call(arguments)),this},hide:function(){return k.hide(),this},disable:function(){return r.stopDelegating(),r._disabled=!0,this},enable:function(){return r._disabled=!1,r.startDelegating(),this},fallback:function(a){return r._fallback=
a,this},setDefaultSkin:function(a){return I.defaults.skin=a,this}}),(q.IE&&7>q.IE||"number"==b.type(q.Android)&&3>q.Android||q.MobileSafari&&"number"==b.type(q.WebKit)&&533.18>q.WebKit)&&(r.show=r.showFallback,b.each(["startDelegating","stopDelegating","initialize"],function(a,d){r[d]=function(){}}),w.hide=function(){return this}),b(document).ready(function(){r.initialize();jQuery.fn.setfocus=function(){return this.each(function(){var a=this;setTimeout(function(){try{a.focus()}catch(d){}},0)})};b(".strp-nav-previous .strp-nav-button").keypress(function(a){13==
a.which&&k.previous()});b(".strp-nav-next .strp-nav-button").keypress(function(a){13==a.which&&k.next()});b(".strp-close").keypress(function(a){13==a.which&&(k.hide(),b(".retiree_info a.strip").setfocus())});$("header a,.acc,.accesskey").focusin(function(){return k.hide(),this})}),w});